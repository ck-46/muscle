<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{{constant('main\\Bootstrap::ENTRY_URL')}}stylesheets/index.css" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="{{constant('main\\Bootstrap::APP_URL')}}js/muscle.js"></script>
    <title>MUSCLE STORE｜商品詳細ページ</title>
</head>
<body>
<input type="hidden" name="entry_url" value="{{constant('main\\Bootstrap::ENTRY_URL')}}" id="entry_url">
<header>
    {% include 'header.html.twig' %}
</header>
<main class="container">
    <div>
        <div>
            <img src="{{constant('main\\Bootstrap::ENTRY_URL')}}images/{{itemData.image}}" alt="{{itemData.item_name}}">
        </div>
        <div>
            <dl>
                <dt>商品名</dt>
                <dd>{{itemData.item_name}}</dd>
                <dt>詳細</dt>
                <dd>{{itemData.detail}}</dd>
                <dt>価格</dt>
                <dd>&yen;{{itemData.price|number_format(0, '.', ',')}}</dd>
            </dl>
            <form method="post" action="cart_in.php">
                <div  class="form-group">
                    {% if errMsg | length > 0 %}
                        <div class="text-danger">{{errMsg}}</div>
                    {% endif %}
                    <label for="amount_{{index}}">数量：</label>
                    <select class="form-control" name="amount">
                        {% for index, label in amountArr %}
                        <option id="amount_{{index}}" value="{{index}}" {% if itemData.amount == index %} selected {% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>
                <input type="hidden" name="item_id" id="item_id" value="{{itemData.item_id}}">
                <input type="submit" class="btn btn-primary" name="cart_in" value="カートへ入れる">
            </form>
            <input type="button" class="btn btn-secondary" name="back" value="一覧へ戻る" onclick="history.back(); return false;">
            <div>
                {% if reviewArr | length > 0 %}
                    <p>レビュー</p>
                    {% for key, value in reviewArr %}
                        <span>投稿日：{{value.review_date | date("Y年m月d日")}}</span>
                        <span>投稿者：{{value.user_name}}さん </span>
                        <p>{{value.content}}</p>
                        {# <input type="hidden" name="user_id" class="user_id" value="{{value.user_id}}">
                        <input type="hidden" name="review_id" class="review_id" value="{{value.review_id}}"> #}

                        {# <a href="{{constant('main\\Bootstrap::ENTRY_URL')}}good.php?user_id={{user_id}}&review_id={{value.review_id}}&item_id={{itemData.item_id}}">Good</a> #}

                        <div class="good_btn" value="{{value.review_id}}">
                            <div class="btn good {% if value.isGood | length > 0 %}active{% endif %}">
                                <input type="hidden" class="user_id" value="{{user_id}}">
                                <input type="hidden" class="review_id" value="{{value.review_id}}">
                                <i class="fa-heart fa-lg px-16 {% if value.isGood | length > 0 %}active fas{% else %}far{% endif %}"></i>
                                <span>{{value.goodAmount}}</span>
                            </div>
                        </div>
                        <br>


{# 
                        <section class="post" data-postid="<?php echo sanitize($p_id); ?>">
                            <div class="btn-good <?php if(isGood($_SESSION['user_id'], $dbPostData['id'])) echo 'active'; ?>">
                                <!-- 自分がいいねした投稿にはハートのスタイルを常に保持する -->
                                <i class="fa-heart fa-lg px-16
                                <?php
                                    if(isGood($_SESSION['user_id'],$dbPostData['id'])){ //いいね押したらハートが塗りつぶされる
                                        echo ' active fas';
                                    }else{ //いいねを取り消したらハートのスタイルが取り消される
                                        echo ' far';
                                    }; ?>"></i><span><?php echo $dbPostGoodNum; ?></span>
                            </div>
                        </section> #}

                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </div>
</main>
<footer>
    {% include 'footer.html.twig' %}
</footer>
</body>
</html>